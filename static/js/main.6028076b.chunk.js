(this["webpackJsonpreact-state-building-script"]=this["webpackJsonpreact-state-building-script"]||[]).push([[0],{13:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(7),c=a.n(r);a(13);function i(){return l.a.createElement("footer",null,l.a.createElement("p",null,"This site is created for demonstrative purposes only and does not offer any real products or services."),l.a.createElement("p",null,"\xa9 Mohamed Nawaz @ CleanCodeOnline 2021"))}var o=a(2);const u={color:"lightblue"};function s(){return l.a.createElement("header",null,l.a.createElement("nav",null,l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement(o.b,{to:"/"},l.a.createElement("img",{alt:"Carved Rock Fitness",src:"/images/logo.png"}))),l.a.createElement("li",null,l.a.createElement(o.c,{activeStyle:u,to:"/shoes"},"Shoes")),l.a.createElement("li",null,l.a.createElement(o.c,{activeStyle:u,to:"/gym"},"Muscle")),l.a.createElement("li",null,l.a.createElement(o.c,{activeStyle:u,to:"/streaching"},"Fitness")),l.a.createElement("li",null,l.a.createElement(o.c,{activeStyle:u,to:"/cart"},"Cart")))))}function m(e){const t=l.a.useRef(!1),[a,n]=l.a.useState(null),[r,c]=l.a.useState(null),[i,o]=l.a.useState(!0);return l.a.useEffect(()=>(t.current=!0,async function(){try{const a=await fetch(Object({NODE_ENV:"production",PUBLIC_URL:"/fitness-care",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_BASE_URL+e);if(!a.ok)throw a;{const e=await a.json();t.current&&n(e)}}catch(a){t.current&&c(a)}finally{t.current&&o(!1)}}(),()=>t.current=!1),[e]),{data:a,error:r,loading:i}}function d(){return l.a.createElement("div",{className:"lds-container"},l.a.createElement("div",{className:"lds-dual-ring"}))}function E(){return l.a.createElement("h1",null,"Page Not Found.")}var p=a(1);function h(){const[e,t]=l.a.useState(""),{category:a}=Object(p.h)(),{data:n,error:r,loading:c}=m("products?category="+a),i=e?n.filter(t=>t.skus.find(t=>t.size===parseInt(e))):n;if(r)throw r;return c?l.a.createElement(d,null):0===n.length?l.a.createElement(E,null):l.a.createElement(l.a.Fragment,null,l.a.createElement("section",{id:"filters"},l.a.createElement("label",{htmlFor:"size"},"Filter by Size:")," ",l.a.createElement("select",{id:"size",value:e,onChange:e=>{t(e.target.value)}},l.a.createElement("option",{value:""},"All sizes"),l.a.createElement("option",{value:"7"},"7"),l.a.createElement("option",{value:"8"},"8"),l.a.createElement("option",{value:"9"},"9"))),e&&l.a.createElement("h2",null,i.length," items found"),l.a.createElement("section",{id:"products"},i.map(e=>l.a.createElement("div",{key:e.id,className:"product"},l.a.createElement(o.b,{to:"/".concat(a,"/").concat(e.id)},l.a.createElement("img",{src:"/images/".concat(e.image),alt:e.name}),l.a.createElement("h3",null,e.name),l.a.createElement("p",null,"$",e.price))))))}var y=a(4);const g=(e,t)=>{switch(t.type){default:throw new Error("Unhandled action type "+t.type);case"empty-cart":return[];case"add-to-cart":{const{id:a,sku:n}=t;return e.find(e=>e.sku===n)?e.map(e=>e.sku===n?Object(y.a)(Object(y.a)({},e),{},{quantity:e.quantity+1}):e):[...e,{id:a,sku:n,quantity:1}]}case"update-cart-quantity":const{sku:a,quantity:n}=t;return 0===n?e.filter(e=>e.sku!==a):e.map(e=>e.sku===a?Object(y.a)(Object(y.a)({},e),{},{quantity:n}):e)}},f=(e,t)=>{switch(t.type){default:throw new Error("Unhandled action type "+t.type);case"handle-address-change":const{e:a}=t;return Object(y.a)(Object(y.a)({},e),{},{[a.target.id]:a.target.value});case"handle-touched-change":const{event:n}=t;return Object(y.a)(Object(y.a)({},e),{},{[n.target.id]:!0})}},v=l.a.createContext(null);let S=[];try{const e=localStorage.getItem("cart");e&&(S=JSON.parse(e))}catch(R){console.error("Failed to parse cart from localStorage",R)}function b({children:e}){const[t,a]=l.a.useReducer(g,S);return l.a.useEffect(()=>{try{localStorage.setItem("cart",JSON.stringify(t))}catch(R){console.error("Failed to save cart to localStorage",R)}},[t]),l.a.createElement(v.Provider,{value:{cart:t,dispatch:a}},e)}const C=l.a.createContext(null);let k={};try{const e=localStorage.getItem("shipping-address");e&&(k=JSON.parse(e))}catch(R){console.error("Failed to parse shipping address from localStorage",R)}function O({children:e}){const[t,a]=l.a.useReducer(f,k);return l.a.useEffect(()=>{try{localStorage.setItem("shipping-address",JSON.stringify(t))}catch(R){console.error("Failed to save shipping address to localStorage",R)}},[t]),l.a.createElement(C.Provider,{value:{shippingAddress:t,dispatchShipping:a}},e)}function N(){const{dispatch:e}=l.a.useContext(v),[t,a]=l.a.useState(""),{id:n}=Object(p.h)(),r=Object(p.g)(),{data:c,error:i,loading:o}=m("products/"+n);if(o)return l.a.createElement(d,null);if(!c)return l.a.createElement(E,null);if(i)throw i;return l.a.createElement("div",{id:"detail"},l.a.createElement("div",{className:"detail-column"},l.a.createElement("h1",null,c.name),l.a.createElement("p",null,c.description),l.a.createElement("p",{id:"price"},"$",c.price),l.a.createElement("select",{id:"size",value:t,onChange:e=>a(e.target.value)},l.a.createElement("option",{value:""},"Size"),c.skus.map(e=>l.a.createElement("option",{key:e.sku,value:e.sku},e.size))),l.a.createElement("p",null,l.a.createElement("button",{className:"btn btn-primary",onClick:()=>{e({type:"add-to-cart",id:n,sku:t}),r("/cart")},disabled:!t},"Add to Cart"))),l.a.createElement("div",{className:"detail-column"},l.a.createElement("img",{src:"/images/".concat(c.image),alt:c.category})))}function I(e){const t=l.a.useRef(!1),[a,n]=l.a.useState(null),[r,c]=l.a.useState(!0),[i,o]=l.a.useState(null);return l.a.useEffect(()=>{t.current=!0;const a=e.map(e=>fetch(Object({NODE_ENV:"production",PUBLIC_URL:"/fitness-care",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_BASE_URL+e).then(e=>{if(e.ok)return e.json();throw e}));return Promise.all(a).then(e=>{t.current&&n(e)}).catch(e=>{console.error(e),t.current&&o(e)}).finally(()=>{t.current&&c(!1)}),()=>t.current=!1},[e]),{data:a,loading:r,error:i}}function w(){const{cart:e,dispatch:t}=l.a.useContext(v),a=Object(p.g)(),n=e.map(e=>"products/".concat(e.id)),{data:r,loading:c,error:i}=I(n);const o=l.a.useMemo(()=>e.reduce((e,t)=>e+t.quantity,0),[e]);if(c)return l.a.createElement(d,null);if(i)throw i;return l.a.createElement(l.a.Fragment,null,l.a.createElement("section",{id:"cart"},0===e.length?l.a.createElement("h1",null,"Cart is empty"):"".concat(o,1===o?" item found":" items found"),l.a.createElement("ul",null,e.map((function(e){const{id:a,sku:n,quantity:c}=e,{price:i,name:o,image:u,skus:s}=r.find(e=>e.id===parseInt(a)),{size:m}=s.find(e=>e.sku===n);return l.a.createElement("li",{key:n,className:"cart-item"},l.a.createElement("img",{src:"/images/".concat(u),alt:o}),l.a.createElement("div",null,l.a.createElement("h3",null,o),l.a.createElement("p",null,"$",i*c),l.a.createElement("p",null,"Size: ",m),l.a.createElement("p",null,l.a.createElement("select",{"aria-label":"Select quantity for ".concat(o," size ").concat(m),onChange:e=>t({type:"update-cart-quantity",sku:n,quantity:parseInt(e.target.value)}),value:c},l.a.createElement("option",{value:"0"},"Remove"),l.a.createElement("option",{value:"1"},"1"),l.a.createElement("option",{value:"2"},"2"),l.a.createElement("option",{value:"3"},"3"),l.a.createElement("option",{value:"4"},"4"),l.a.createElement("option",{value:"5"},"5")))))})))),e.length?l.a.createElement("p",null,l.a.createElement("button",{className:"btn btn-primary",onClick:()=>a("/checkout")},"Checkout")):null)}const _=[{city:"Mumbai",country:"India",id:1},{city:"London",country:"United Kingdom",id:2},{country:"United Kingdom",city:"London",id:3}];const F="IDLE",T="SUBMITTING",P="SUBMITTED",U="COMPLETED",j="PAYED";function A(){let e=0;const{cart:t,dispatch:a}=l.a.useContext(v),n=t.map(e=>"products/".concat(e.id)),{data:r,loading:c,error:i}=I(n),{shippingAddress:o,dispatchShipping:u}=l.a.useContext(C),[s,m]=l.a.useState(F),[E,p]=l.a.useState(null),[h,y]=l.a.useReducer(f,{}),g=function(e){const t={};e.city||(t.city="city is required");e.country||(t.country="country is required");return t}(o),S=0===Object.keys(g).length;function b(e){e.persist(),u({type:"handle-address-change",e:e})}function k(e){e.persist(),y({type:"handle-touched-change",event:e})}async function O(e){if(e.preventDefault(),m(T),S)try{localStorage.setItem("shipping-address",JSON.stringify(o)),await async function(e){return new Promise(t=>{setTimeout(()=>{const a=_.findIndex(t=>t.id===e.id);a>=0?_[a]=e:_.push(e),t({success:!0})},200)})}(o),m(U)}catch(t){p(t)}else m(P)}const N=l.a.useMemo(()=>t.reduce((e,t)=>e+t.quantity,0),[t]);if(c)return l.a.createElement(d,null);if(i)throw i;if(E)throw E;return s===j?l.a.createElement("h1",null,"Thanks for shopping"):l.a.createElement(l.a.Fragment,null,o.city&&o.country?l.a.createElement("main",{id:"checkout-main"},l.a.createElement("div",{className:"cart"},l.a.createElement("h1",null,"Cart"),l.a.createElement("section",{id:"cart"},"".concat(N,1===N?" item found":" items found"),l.a.createElement("ul",null,t.map((function(t){const{id:a,sku:n,quantity:c}=t,{price:i,name:o,image:u,skus:s}=r.find(e=>e.id===parseInt(a)),{size:m}=s.find(e=>e.sku===n);return e+=i*c,l.a.createElement("li",{key:n,className:"cart-item"},l.a.createElement("img",{src:"/images/".concat(u),alt:o}),l.a.createElement("div",null,l.a.createElement("h3",null,o),l.a.createElement("p",null,"$",i*c),l.a.createElement("p",null,"Size: ",m),l.a.createElement("p",null,"Quantity: ",c)))})))),l.a.createElement("p",{style:{color:"green",fontWeight:"bold"}},"$ ".concat(Math.ceil(e))),l.a.createElement("form",{onSubmit:function(e){e.preventDefault(),a({type:"empty-cart"}),m(j)}},l.a.createElement("div",null,l.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Checkout",disabled:s===T})))),l.a.createElement("div",{className:"shipping-info"},l.a.createElement("div",{style:{marginBottom:20}},l.a.createElement("h1",null,"Shipping Info")),!S&&s===P&&l.a.createElement("div",{role:"alert"},l.a.createElement("p",null,"Please fix the following errors"),l.a.createElement("ul",null,Object.keys(g).map(e=>l.a.createElement("li",{key:e},g[e])))),l.a.createElement("form",{onSubmit:O},l.a.createElement("div",null,l.a.createElement("label",{htmlFor:"city"},"City"),l.a.createElement("br",null),l.a.createElement("input",{id:"city",type:"text",value:o.city,onBlur:k,onChange:b}),l.a.createElement("p",{role:"alert"},(h.city||s===P)&&g.city)),l.a.createElement("div",null,l.a.createElement("label",{htmlFor:"country"},"Country"),l.a.createElement("br",null),l.a.createElement("select",{id:"country",value:o.country,onBlur:k,onChange:b},l.a.createElement("option",{value:""},"Select Country"),l.a.createElement("option",{value:"China"},"China"),l.a.createElement("option",{value:"India"},"India"),l.a.createElement("option",{value:"United Kingdom"},"United Kingdom"),l.a.createElement("option",{value:"USA"},"USA")),l.a.createElement("p",{role:"alert"},(h.country||s===P)&&g.country)),l.a.createElement("div",null,s===U&&l.a.createElement("p",{style:{color:"blue"}},"Shipping address saved"),l.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Save Shipping Info",disabled:s===T}))))):l.a.createElement("main",{id:"checkout-main"},l.a.createElement("div",{className:"shipping-info"},l.a.createElement("h1",null,"Shipping Info"),!S&&s===P&&l.a.createElement("div",{role:"alert"},l.a.createElement("p",null,"Please fix the following errors"),l.a.createElement("ul",null,Object.keys(g).map(e=>l.a.createElement("li",{key:e},g[e])))),l.a.createElement("form",{onSubmit:O},l.a.createElement("div",null,l.a.createElement("label",{htmlFor:"city"},"City"),l.a.createElement("br",null),l.a.createElement("input",{id:"city",type:"text",value:o.city,onBlur:k,onChange:b}),l.a.createElement("p",{role:"alert"},(h.city||s===P)&&g.city)),l.a.createElement("div",null,l.a.createElement("label",{htmlFor:"country"},"Country"),l.a.createElement("br",null),l.a.createElement("select",{id:"country",value:o.country,onBlur:k,onChange:b},l.a.createElement("option",{value:""},"Select Country"),l.a.createElement("option",{value:"China"},"China"),l.a.createElement("option",{value:"India"},"India"),l.a.createElement("option",{value:"United Kingdom"},"United Kingdom"),l.a.createElement("option",{value:"USA"},"USA")),l.a.createElement("p",{role:"alert"},(h.country||s===P)&&g.country)),l.a.createElement("div",null,s===U&&l.a.createElement("p",{style:{color:"blue"}},"Shipping address saved"),l.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Save Shipping Info",disabled:s===T}))))))}function z(){const[e,t]=l.a.useState(""),{data:a,error:n,loading:r}=m("products"),c=e?a.filter(t=>t.category===e):a;if(n)throw n;if(r)return l.a.createElement(d,null);if(0===a.length)return l.a.createElement(E,null);const i=a.map(e=>e.category),u=[...new Set(i)];return l.a.createElement(l.a.Fragment,null,l.a.createElement("section",{id:"filters"},l.a.createElement("label",{htmlFor:"size"},"Filter by Category:")," ",l.a.createElement("select",{id:"size",value:e,onChange:e=>{t(e.target.value)}},l.a.createElement("option",{value:""},"Select category"),u.map(e=>l.a.createElement("option",{key:e,value:e},e)))),e&&l.a.createElement("h2",null,c.length," items found"),l.a.createElement("section",{id:"products"},c.map(e=>l.a.createElement("div",{key:e.id,className:"product"},l.a.createElement(o.b,{to:"/".concat(e.category,"/").concat(e.id)},l.a.createElement("img",{src:"/images/".concat(e.image),alt:e.name}),l.a.createElement("h3",null,e.name),l.a.createElement("p",null,"$",e.price))))))}function q(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"content"},l.a.createElement(s,null),l.a.createElement("main",null,l.a.createElement(p.c,null,l.a.createElement(p.a,{path:"/",element:l.a.createElement(l.a.Fragment,null,l.a.createElement("h1",null,"Welcome to Fitness Care"),l.a.createElement(z,null))}),l.a.createElement(p.a,{path:"/:category",element:l.a.createElement(h,null)}),l.a.createElement(p.a,{path:"/:category/:id",element:l.a.createElement(N,null)}),l.a.createElement(p.a,{path:"/cart",element:l.a.createElement(w,null)}),l.a.createElement(p.a,{path:"/checkout",element:l.a.createElement(O,null,l.a.createElement(A,null))})))),l.a.createElement(i,null))}class D extends l.a.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}render(){return this.state.hasError?l.a.createElement("h1",null,"Something went wrong."):this.props.children}}c.a.render(l.a.createElement(D,null,l.a.createElement(o.a,null,l.a.createElement(b,null,l.a.createElement(q,null)))),document.getElementById("root"))},8:function(e,t,a){e.exports=a(16)}},[[8,1,2]]]);
//# sourceMappingURL=main.6028076b.chunk.js.map